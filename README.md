# Work Per Hour

Documentation URL : *Integerate Swagger and add STAGING URL HERE*

## Getting the project running on local machine using Docker:
- Copy example.env to a new file .env
- Make Sure your APP_USER_ID equal to the result of this command `id -u`
- Run `docker-compose up`
- Run Migrations `docker-compose exec quire_backend rails db:migrate`
- Run Seeds `docker-compose exec quire_backend rails db:seed`
- Run Configurations Seeds
```
docker-compose exec quire_backend rails c

Configuration.seed

# Add Cities
$ docker-compose exec quire_backend bundle exec rake add_cities:generate_Cities
```

## rake tasks
- contracts:update_creator_id

## Unit Test
- *ADD A way to access simplecov reports on staging here*
- Run Migrations in test environment `docker-compose exec quire_backend rails db:migrate RAILS_ENV=test`
- Run Specs `docker-compose exec quire_backend rspec`

## Swagger
- Generate your controller spec using command:
`rails generate rspec:swagger API::V1::TestController`
- `rswag` create Swagger documentation from RSpec.
- To generate Swagger documentation run `docker-compose exec quire_backend rake rswag:specs:swaggerize`

## MailTrap on UAT
1. Problem description:
   - takamol don't allowing sending to `MailTrap` servers.
   - Old solution:
     @ali-elkemany made a proxy server `161.35.7.127` to send `MailTrap` requests throw port `80`
   - New solution (Applied now)
     takamol finally allowed sending requests to `MailTrap`, so UAT is now configured normally tp send email with `MailTrap`

# Load Database dump
1. Make sure the App is up

   `docker-compose up`

2. Stop quire_backend container

   `docker compose stop quire_backend`

3. Run psql command on quire_backend_development

   `docker-compose exec quire_backend_development_database psql -U quire_backend -d postgres`

4. Drop database

   quire_backend_development=#`drop database quire_backend_development;`

5. Create database

   quire_backend_development=#`create database quire_backend_development;`

6. Load dump file

   `docker exec -i quire_backend_database_development psql -U quire_backend -d quire_backend_development < PATH_TO_SQL_FILE`


# Environmental Variables:

- Note : this list might not have all the needed env. variables, if you faced any problem after adding all values from .env.example and the README, Please refer back to values from the Staging server


## Development
- DEVELOPMENT_QUIRE_BACKEND_DATABASE_DATABASE_NAME
- DEVELOPMENT_QUIRE_BACKEND_DATABASE_USER
- DEVELOPMENT_QUIRE_BACKEND_DATABASE_PASSWORD
- DEVELOPMENT_QUIRE_BACKEND_DATABASE_HOST_NAME
- DEVELOPMENT_QUIRE_BACKEND_REDIS_DB
- DEVELOPMENT_QUIRE_BACKEND_REDIS_PORT
- DEVELOPMENT_QUIRE_BACKEND_REDIS_URL
- DEVELOPMENT_ABSHER_SEND_SMS_URL
- DEVELOPMENT_ABSHER_USER_VERIFICATION_URL
- DEVELOPMENT_SMS_ENABLED
- DEVELOPMENT_SMS_MAILER_ENABLED
- DEVELOPMENT_UNIFONIC_URL
- DEVELOPMENT_UNIFONIC_APP_SID
- DEVELOPMENT_UNIFONIC_USERNAME
- DEVELOPMENT_UNIFONIC_PASSWORD
- DEVELOPMENT_UNIFONIC_SENDER_ID
- DEVELOPMENT_TAKAMOL_PAYMENT_API_KEY
- DEVELOPMENT_TAKAMOL_PAYMENT_API_SECRET
- DEVELOPMENT_TAKAMOL_PAYMENT_AUTHORIZATION
- DEVELOPMENT_TAKAMOL_PAYMENT_SYSTEM_ID
- DEVELOPMENT_TAKAMOL_PAYMENT_DEFINE_BILL_URL
- DEVELOPMENT_TAKAMOL_PAYMENT_BILLING_TEMPLATE_ID
- DEVELOPMENT_TAKAMOL_PAYMENT_ITEM_TEMPLATE_ID
- DEVELOPMENT_TAKAMOL_PAYMENT_DUE_DATE_IN_DAYS
- DEVELOPMENT_SMS_LOGS_RECEIVER
- DEVELOPMENT_SMS_CONTRACT_PATH
- DEVELOPMENT_CUTTLY_URL
- DEVELOPMENT_CUTTLY_API_KEY
- DEVELOPMENT_ASSET_HOST
- DEVELOPMENT_MOCK_COMPANY_LOGIN
- DEVELOPMENT_UPDATE_COMPANY_DATA
- DEVELOPMENT_HOST
- DEVELOPMENT_FRONTEND_LOGIN_PATH
- DEVELOPMENT_FRONTEND_COMPLETE_PROFILE_PATH
- DEVELOPMENT_FRONTEND_REGISTERATION_PATH
- INVALID_DAILY_TRIES_QUOTA

## TEST
- TEST_QUIRE_BACKEND_DATABASE_DATABASE_NAME
- TEST_QUIRE_BACKEND_DATABASE_USER
- TEST_QUIRE_BACKEND_DATABASE_PASSWORD
- TEST_QUIRE_BACKEND_DATABASE_HOST_NAME
- TEST_SMS_LOGS_RECEIVER
- TEST_SMS_FRONTEND_CONTRACT_PATH
- TEST_CUTTLY_URL
- TEST_CUTTLY_API_KEY
- TEST_ASSET_HOST
- TEST_SMS_ENABLED
- TEST_SMS_MAILER_ENABLED
- TEST_MOCK_COMPANY_LOGIN
- TEST_UPDATE_COMPANY_DATA
- TEST_HOST
- TEST_FRONTEND_LOGIN_PATH
- TEST_FRONTEND_COMPLETE_PROFILE_PATH
- TEST_FRONTEND_REGISTERATION_PATH
- INVALID_DAILY_TRIES_QUOTA

## Staging
- STAGING_QUIRE_BACKEND_DATABASE_DATABASE_NAME
- STAGING_QUIRE_BACKEND_DATABASE_USER
- STAGING_QUIRE_BACKEND_DATABASE_PASSWORD
- STAGING_QUIRE_BACKEND_DATABASE_HOST_NAME
- STAGING_QUIRE_BACKEND_REDIS_DB
- STAGING_QUIRE_BACKEND_REDIS_HOST
- STAGING_QUIRE_BACKEND_REDIS_PORT
- STAGING_QUIRE_BACKEND_REDIS_URL
- STAGING_QUIRE_BACKEND_SENTRY_DSN
- STAGING_ABSHER_SEND_SMS_URL
- STAGING_ABSHER_USER_VERIFICATION_URL
- STAGING_UNIFONIC_URL
- STAGING_UNIFONIC_APP_SID
- STAGING_UNIFONIC_USERNAME
- STAGING_UNIFONIC_PASSWORD
- STAGING_UNIFONIC_SENDER_ID
- STAGING_TAKAMOL_PAYMENT_API_KEY
- STAGING_TAKAMOL_PAYMENT_API_SECRET
- STAGING_TAKAMOL_PAYMENT_AUTHORIZATION
- STAGING_TAKAMOL_PAYMENT_SYSTEM_ID
- STAGING_TAKAMOL_PAYMENT_DEFINE_BILL_URL
- STAGING_TAKAMOL_PAYMENT_BILLING_TEMPLATE_ID
- STAGING_TAKAMOL_PAYMENT_ITEM_TEMPLATE_ID
- STAGING_TAKAMOL_PAYMENT_DUE_DATE_IN_DAYS
- STAGING_SMS_LOGS_RECEIVER
- STAGING_SMS_CONTRACT_PATH
- STAGING_CUTTLY_URL
- STAGING_CUTTLY_API_KEY
- STAGING_ASSET_HOST
- STAGING_SMS_ENABLED
- STAGING_SMS_MAILER_ENABLED
- STAGING_MOCK_COMPANY_LOGIN
- STAGING_UPDATE_COMPANY_DATA
- STAGING_HOST
- STAGING_FRONTEND_LOGIN_PATH
- STAGING_FRONTEND_COMPLETE_PROFILE_PATH
- INVALID_DAILY_TRIES_QUOTA

## Production
- PRODUCTION_QUIRE_BACKEND_DATABASE_DATABASE_NAME
- PRODUCTION_QUIRE_BACKEND_DATABASE_USER
- PRODUCTION_QUIRE_BACKEND_DATABASE_PASSWORD
- PRODUCTION_QUIRE_BACKEND_DATABASE_HOST_NAME
- PRODUCTION_QUIRE_BACKEND_DATABASE_PORT
- PRODUCTION_QUIRE_BACKEND_REDIS_DB
- PRODUCTION_QUIRE_BACKEND_REDIS_HOST
- PRODUCTION_QUIRE_BACKEND_REDIS_PORT
- PRODUCTION_QUIRE_BACKEND_REDIS_URL
- PRODUCTION_QUIRE_BACKEND_SENTRY_DSN
- PRODUCTION_ABSHER_SEND_SMS_URL
- PRODUCTION_ABSHER_USER_VERIFICATION_URL
- PRODUCTION_UNIFONIC_URL
- PRODUCTION_UNIFONIC_APP_SID
- PRODUCTION_UNIFONIC_USERNAME
- PRODUCTION_UNIFONIC_PASSWORD
- PRODUCTION_UNIFONIC_SENDER_ID
- PRODUCTION_TAKAMOL_PAYMENT_API_KEY
- PRODUCTION_TAKAMOL_PAYMENT_API_SECRET
- PRODUCTION_TAKAMOL_PAYMENT_AUTHORIZATION
- PRODUCTION_TAKAMOL_PAYMENT_SYSTEM_ID
- PRODUCTION_TAKAMOL_PAYMENT_DEFINE_BILL_URL
- PRODUCTION_TAKAMOL_PAYMENT_BILLING_TEMPLATE_ID
- PRODUCTION_TAKAMOL_PAYMENT_ITEM_TEMPLATE_ID
- PRODUCTION_TAKAMOL_PAYMENT_DUE_DATE_IN_DAYS
- PRODUCTION_SMS_CONTRACT_PATH
- PRODUCTION_CUTTLY_URL
- PRODUCTION_CUTTLY_API_KEY
- PRODUCTION_ASSET_HOST
- PRODUCTION_SMS_ENABLED
- PRODUCTION_SMS_MAILER_ENABLED
- PRODUCTION_MOCK_COMPANY_LOGIN
- PRODUCTION_UPDATE_COMPANY_DATA
- PRODUCTION_HOST
- PRODUCTION_FRONTEND_LOGIN_PATH
- PRODUCTION_FRONTEND_COMPLETE_PROFILE_PATH
- PRODUCTION_FRONTEND_REGISTERATION_PATH
- PRODUCTION_NLG_ENDPOINT
- PRODUCTION_NLG_USERNAME
- PRODUCTION_NLG_PASSWORD
- INVALID_DAILY_TRIES_QUOTA
- PRODUCTION_SMTP_MAILER
- PRODUCTION_SMTP_USER_NAME
- PRODUCTION_SMTP_PASSWORD
- PRODUCTION_SMTP_ADDRESS
- PRODUCTION_SMTP_DOMAIN
- PRODUCTION_SMTP_PORT
- PRODUCTION_REDIS_NAMESPACE
- PRODUCTION_CONFIGURATIONS_CACHE_REDIS_DB
- PRODUCTION_NOTIFICATION_REDIS_DB
- PRODUCTION_AUTH_TOKENS_BLACKLIST_DB
- PRODUCITON_WEBSOCKET_FRONTEND_URL
- PRODUCTION_CHECK_ELIGIBILITY_ENABLED
- PRODUCTION_FEATURES_FLAGS_DB
